# NeuralUpscaler

**NeuralUpscaler** - это приложение для локального улучшения качества изображений и видео с использованием нейронных сетей. Программа построена на базе Python и PySide6, использует архитектуру RealESRGAN и высокопроизводительный ONNX Runtime для ускорения вычислений.

Цель проекта - предоставить удобный графический интерфейс для алгоритмов Super-Resolution, позволяя обрабатывать медиафайлы без отправки данных в облако, используя ресурсы вашего собственного оборудования (GPU или CPU).

## Основные возможности

### Графический интерфейс и сравнение
Приложение оснащено интерфейсом с поддержкой Drag-and-Drop. Ключевой особенностью является интерактивный слайдер "До/После", который позволяет в реальном времени оценить качество работы, сравнивая исходное изображение с результатом апскейлинга. Вы можете перемещать изображение и приближать его колёсиком мыши для детального анализа текстур.

### Обработка изображений и видео
NeuralUpscaler поддерживает широкий спектр форматов. Для изображений доступны форматы PNG, JPG, и WEBP. Видеофайлы (MP4, AVI, MOV) обрабатываются покадрово с последующей автоматической склейкой и сохранением оригинальной аудиодорожки. Поддерживается пакетная обработка: вы можете загрузить целую папку файлов, настроить параметры и оставить компьютер выполнять работу.

### Адаптивная производительность
Система автоматически определяет доступное оборудование. Приоритет отдается аппаратному ускорению через DirectML (DirectX 12), что обеспечивает широкую совместимость с большинством современных видеокарт (AMD, Intel, NVIDIA) на ОС Windows. Если дискретная видеокарта недоступна или не поддерживается, вычисления переводятся на процессор.

### Оптимизация моделей
В проекте используются модели RealESRGAN (x2 и x4), конвертированные в формат ONNX с точностью FP16 (half-precision). Это обеспечивает существенный прирост скорости обработки и снижение потребления памяти при сохранении высокого качества результирующего изображения.

---

## Установка и запуск

Проект использует систему управления зависимостями **Poetry** и требует установленного интерпретатора Python версии 3.12 или выше.

**1. Клонирование репозитория**
```bash
git clone https://github.com/your-username/neural-upscaler.git
cd neural-upscaler
```

**2. Установка зависимостей**
Выполните следующую команду для создания виртуального окружения и установки всех необходимых библиотек:
```bash
poetry install
```

**3. Подготовка весов моделей**
Для работы программы необходимы файлы моделей в формате ONNX. Убедитесь, что файлы `RealESRGAN_x2plus_fp16.onnx` и `RealESRGAN_x4plus_fp16.onnx` находятся в директории:
`./upscaler/weights/`

*Если у вас есть только PyTorch модели (.pth), вы можете сконвертировать их, используя скрипты из папки `upscaler/dev_scripts`.*

**4. Запуск приложения**
```bash
poetry run python upscaler/src/neural_upscaler/main.py
```

---

## Требования к FFmpeg

Для работы с видеофайлами (извлечение кадров и склейка со звуком) в системе должен быть установлен **FFmpeg**.

1.  Скачайте FFmpeg с официального сайта.
2.  Добавьте путь к исполняемому файлу `ffmpeg` в переменную среды PATH вашей операционной системы.
3.  Программа автоматически проверит наличие FFmpeg при запуске. Если он не найден, вкладка обработки видео будет недоступна, но функции улучшения изображений продолжат работать.